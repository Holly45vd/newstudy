"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[112],{1112:(n,e,t)=>{t.r(e),t.d(e,{default:()=>T});var i=t(9379),s=t(5043),o=t(3023),r=t(1911),a=t(8776),l=t(9806),c=t(298),d=t(8065),u=t(2097),x=t(2579),h=t(2775),p=t(6803),g=t(3089),A=t(4799),f=t(5895),y=t(3759),m=t(5877),v=t(3969),j=t(5362),w=t(9302),S=t(1773),z=t(9817),b=t(9992),k=t(579);const C=(0,b.A)((0,k.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add");var I=t(9928),O=t(9946),P=t(4014),J=t(6667);const N={zh:"",pinyin:"",ko:"",pos:"",tags:[],sentence:"",sentencePinyin:"",sentenceKo:"",sentenceKoPronunciation:"",grammar:[],extensions:[{zh:"",pinyin:"",ko:"",koPron:""}],keyPoints:[],pronunciation:[]},W=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=(0,i.A)({},n);return e.zh||!e.hanzi&&!e.id||(e.zh=e.hanzi||e.id),null==e.sentenceKoPronunciation&&null!=e.sentencePron&&(e.sentenceKoPronunciation=e.sentencePron),Array.isArray(e.extensions)&&(e.extensions=e.extensions.map(n=>{const e=(0,i.A)({},n||{});return null==e.koPron&&null!=e.pron&&(e.koPron=e.pron),e})),e},D=function(){var n,e,t;let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return String(null!==(n=null!==(e=null!==(t=i.id)&&void 0!==t?t:i.zh)&&void 0!==e?e:i.hanzi)&&void 0!==n?n:"").trim()},M=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const e=new Map((arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).map(n=>[D(n),n])),t=[],i=new Set;for(const s of n.map(String)){if(i.has(s))continue;const n=e.get(s);n&&(t.push(n),i.add(s))}return t};async function K(n,e){const t=(0,J.doc)(P.db,"units",String(n)),i=await(0,J.getDoc)(t),s=i.exists()?i.data():{};return{ref:t,data:s,arr:Array.isArray(null===s||void 0===s?void 0:s[e])?s[e]:[]}}function T(n){let{open:e,onClose:t}=n;const{unitId:i,unit:b,reloadUnit:P}=(0,I.Q)(),T=(0,s.useMemo)(()=>Array.isArray(null===b||void 0===b?void 0:b.vocabIds)?"vocabIds":Array.isArray(null===b||void 0===b?void 0:b.wordIds)?"wordIds":"vocabIds",[b]),E=(0,s.useMemo)(()=>(Array.isArray(null===b||void 0===b?void 0:b[T])?b[T]:[]).map(String),[b,T]),[R,F]=(0,s.useState)(null),[L,_]=(0,s.useState)(""),[B,H]=(0,s.useState)([]),[Q,U]=(0,s.useState)(!1),[V,q]=(0,s.useState)(""),[G,X]=(0,s.useState)({index:-1,originalId:""}),Y=(0,s.useCallback)(async()=>{try{const n=E.length?await(0,O.pi)(E):[];H(M(E,n))}catch(n){console.error(n),H([])}},[E]);(0,s.useEffect)(()=>{e&&(F(null),_(""),U(!1),Y())},[e,Y]);const Z=(0,s.useMemo)(()=>{const n=(L||"").trim().toLowerCase();if(!n)return B;return B.filter(e=>{var t,i,s,o;const r=null!==(t=null!==(i=null!==(s=e.zh)&&void 0!==s?s:e.hanzi)&&void 0!==i?i:e.id)&&void 0!==t?t:e.cn,a=Array.isArray(e.tags)?e.tags.join(" "):"";let l="";if("string"===typeof e.pronunciation)l=e.pronunciation;else if(Array.isArray(e.pronunciation)&&e.pronunciation.length){var c,d;l=(null===(c=e.pronunciation[0])||void 0===c?void 0:c.ko)||(null===(d=e.pronunciation[0])||void 0===d?void 0:d.pinyin)||""}return[r,e.pinyin,null!==(o=e.ko)&&void 0!==o?o:e.meaning,e.pos,a,e.sentence,e.sentencePinyin,e.sentenceKo,l].filter(Boolean).some(e=>(n=>(n||"").toString().toLowerCase())(e).includes(n))})},[B,L]),$=(n,e)=>{const t=D(e);X({index:n,originalId:t}),q(JSON.stringify(e,null,2)),U(!0)},nn=async n=>{const e=D(n);if(e&&window.confirm("".concat(e," \ub2e8\uc5b4\ub97c \uc774 \uc720\ub2db\uc5d0\uc11c \uc81c\uac70\ud560\uae4c\uc694? (/words \ubb38\uc11c\ub294 \ubcf4\uc874\ub429\ub2c8\ub2e4)")))try{await async function(n,e,t){const{ref:i,arr:s}=await K(n,e),o=s.map(String).filter(n=>n!==String(t));return o.length!==s.length&&await(0,J.updateDoc)(i,{[e]:o,updatedAt:Date.now()}),o}(i,T,e),F({type:"success",text:"\uc720\ub2db\uc5d0\uc11c \uc81c\uac70 \uc644\ub8cc"}),await Y(),"function"===typeof P&&await P()}catch(t){F({type:"error",text:(null===t||void 0===t?void 0:t.message)||"\uc81c\uac70 \uc2e4\ud328"})}};return(0,k.jsxs)(o.A,{open:e,onClose:t,maxWidth:"xl",fullWidth:!0,children:[(0,k.jsxs)(r.A,{children:["\ub2e8\uc5b4 \uad00\ub9ac (\uc720\ub2db) \u2014 /words \uc800\uc7a5 + unit.",T," \uc5f0\uacb0"]}),(0,k.jsx)(a.A,{dividers:!0,sx:{p:0},children:(0,k.jsxs)(l.A,{maxWidth:"lg",sx:{py:2},children:[(0,k.jsxs)(c.A,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{mb:2},children:[(0,k.jsxs)(c.A,{direction:"row",spacing:1,alignItems:"center",children:[(0,k.jsx)(d.A,{title:"\uc0c8 \ub2e8\uc5b4 \ucd94\uac00(\ud15c\ud50c\ub9bf\uc73c\ub85c \uc2dc\uc791)",children:(0,k.jsx)("span",{children:(0,k.jsx)(u.A,{variant:"contained",startIcon:(0,k.jsx)(C,{}),onClick:()=>{X({index:-1,originalId:""}),q(JSON.stringify(N,null,2)),U(!0)},sx:{textTransform:"none"},children:"\uc0c8 \ub2e8\uc5b4"})})}),(0,k.jsx)(d.A,{title:"\ubaa9\ub85d \uc0c8\ub85c\uace0\uce68",children:(0,k.jsx)("span",{children:(0,k.jsx)(x.A,{onClick:Y,children:(0,k.jsx)(w.A,{})})})})]}),(0,k.jsx)(h.A,{placeholder:"\uac80\uc0c9: \ud55c\uc790/\ubcd1\uc74c/\ub73b/\uc608\ubb38/\ud488\uc0ac/\ud0dc\uadf8",size:"small",value:L,onChange:n=>_(n.target.value)})]}),R&&(0,k.jsx)(p.A,{severity:R.type,sx:{mb:2},children:R.text}),(0,k.jsx)(g.A,{container:!0,spacing:2,children:(0,k.jsx)(g.A,{item:!0,xs:12,children:(0,k.jsxs)(A.A,{variant:"outlined",sx:{p:2},children:[(0,k.jsxs)(f.A,{variant:"subtitle1",sx:{fontWeight:700,mb:1},children:["\ub2e8\uc5b4 \ubaa9\ub85d (",Z.length," / ",B.length,") \u2014 \ud544\ub4dc: ",(0,k.jsx)("b",{children:T})]}),(0,k.jsxs)(c.A,{spacing:1,children:[Z.map(n=>{var e,t,i,s;const o=D(n)||"item";return(0,k.jsxs)(c.A,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{p:.75,borderRadius:1,"&:hover":{background:"#fafafa",cursor:"pointer"}},onClick:()=>$(B.indexOf(n),n),children:[(0,k.jsxs)(c.A,{direction:"row",spacing:1,alignItems:"center",children:[(0,k.jsx)(f.A,{sx:{fontWeight:700,minWidth:80},children:null!==(e=null!==(t=n.zh)&&void 0!==t?t:n.hanzi)&&void 0!==e?e:n.id}),(0,k.jsxs)(f.A,{variant:"body2",color:"text.secondary",children:[(n.pinyin||"").trim()," \u2014 ",(null!==(i=null!==(s=n.ko)&&void 0!==s?s:n.meaning)&&void 0!==i?i:"").trim()]}),n.pos&&(0,k.jsx)(y.A,{size:"small",label:n.pos,sx:{ml:1}}),(n.tags||[]).map(n=>(0,k.jsx)(y.A,{size:"small",variant:"outlined",label:n,sx:{ml:.5}},n))]}),(0,k.jsxs)(c.A,{direction:"row",spacing:.5,alignItems:"center",onClick:n=>n.stopPropagation(),children:[(0,k.jsx)(d.A,{title:"JSON \ubcf5\uc0ac",children:(0,k.jsx)(x.A,{size:"small",onClick:()=>(async n=>{try{await navigator.clipboard.writeText(JSON.stringify(n,null,2)),F({type:"success",text:"JSON\uc774 \ud074\ub9bd\ubcf4\ub4dc\uc5d0 \ubcf5\uc0ac\ub418\uc5c8\uc2b5\ub2c8\ub2e4."})}catch(e){F({type:"error",text:"\ubcf5\uc0ac \uc2e4\ud328: \ube0c\ub77c\uc6b0\uc800 \uad8c\ud55c\uc744 \ud655\uc778\ud558\uc138\uc694."})}})(n),children:(0,k.jsx)(z.A,{fontSize:"small"})})}),(0,k.jsx)(d.A,{title:"JSON \ud3b8\uc9d1",children:(0,k.jsx)(x.A,{size:"small",onClick:()=>$(B.indexOf(n),n),children:(0,k.jsx)(S.A,{fontSize:"small"})})}),(0,k.jsx)(d.A,{title:"\uc720\ub2db\uc5d0\uc11c \uc81c\uac70(\uc5f0\uacb0\ub9cc \uc0ad\uc81c)",children:(0,k.jsx)(x.A,{size:"small",onClick:()=>nn(n),children:(0,k.jsx)(j.A,{fontSize:"small"})})})]})]},o)}),0===Z.length&&(0,k.jsx)(f.A,{variant:"body2",color:"text.secondary",children:"\uacb0\uacfc\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."})]})]})})})]})}),(0,k.jsx)(m.A,{children:(0,k.jsx)(u.A,{onClick:t,children:"\ub2eb\uae30"})}),(0,k.jsxs)(o.A,{open:Q,onClose:()=>U(!1),maxWidth:"md",fullWidth:!0,children:[(0,k.jsx)(r.A,{children:(0,k.jsx)(c.A,{direction:"row",justifyContent:"space-between",alignItems:"center",children:(0,k.jsxs)(f.A,{variant:"h6",sx:{fontWeight:700},children:["JSON \ud3b8\uc9d1 \u2014 ",G.index>=0?G.originalId:"\uc0c8 \ub2e8\uc5b4"]})})}),(0,k.jsxs)(a.A,{dividers:!0,children:[(0,k.jsx)(h.A,{value:V,onChange:n=>q(n.target.value),multiline:!0,minRows:18,fullWidth:!0,InputProps:{sx:{fontFamily:"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace",fontSize:13}}}),(0,k.jsxs)(f.A,{variant:"body2",color:"text.secondary",sx:{mt:1},children:["* ",(0,k.jsx)("b",{children:"zh/hanzi/id"})," \uc911 \ud558\ub098\ub294 \ubc18\ub4dc\uc2dc \uc788\uc5b4\uc57c \ud569\ub2c8\ub2e4. \uc800\uc7a5 \uc2dc /words\uc5d0 \ubc18\uc601\ub418\uace0 \ud604\uc7ac \uc720\ub2db(",(0,k.jsx)("b",{children:T}),")\uc5d0 \uc5f0\uacb0\ub429\ub2c8\ub2e4."]})]}),(0,k.jsxs)(m.A,{children:[(0,k.jsx)(u.A,{onClick:()=>U(!1),sx:{textTransform:"none"},children:"\ub2eb\uae30"}),(0,k.jsx)(u.A,{variant:"contained",onClick:async()=>{try{const n=JSON.parse(V);if(!n||"object"!==typeof n)throw new Error("\uc62c\ubc14\ub978 JSON \uac1d\uccb4\uac00 \uc544\ub2d9\ub2c8\ub2e4.");const e=W(n),t=D(e);if(!t)throw new Error("wordId(zh/hanzi/id) \uc911 \ud558\ub098\ub294 \ud544\uc218\uc785\ub2c8\ub2e4.");await(0,O.kS)(t,e);const s=G.originalId;s?s!==t&&await async function(n,e,t,i){const{ref:s,arr:o}=await K(n,e),r=o.map(String),a=r.indexOf(String(t));if(-1===a){const n=[...r,String(i)];return await(0,J.updateDoc)(s,{[e]:n,updatedAt:Date.now()}),n}const l=r.slice();l[a]=String(i);for(let c=l.length-1;c>=0;c--)c!==a&&l[c]===String(i)&&l.splice(c,1);return await(0,J.updateDoc)(s,{[e]:l,updatedAt:Date.now()}),l}(i,T,s,t):await async function(n,e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const{ref:i,arr:s}=await K(n,e),o=s.map(String),r=t.map(String).filter(n=>!o.includes(n)),a=[...o,...r];return r.length>0&&await(0,J.updateDoc)(i,{[e]:a,updatedAt:Date.now()}),a}(i,T,[t]),F({type:"success",text:"\uc800\uc7a5 \uc644\ub8cc"}),U(!1),await Y(),"function"===typeof P&&await P()}catch(n){F({type:"error",text:"JSON \uc800\uc7a5 \uc2e4\ud328: ".concat(n.message)})}},sx:{textTransform:"none"},children:"\uc800\uc7a5"})]})]}),R&&(0,k.jsx)(v.A,{sx:{position:"fixed",inset:"auto 24px 24px auto",zIndex:1300},children:(0,k.jsx)(p.A,{severity:R.type,onClose:()=>F(null),variant:"filled",sx:{boxShadow:2},children:R.text})})]})}}}]);
//# sourceMappingURL=112.12e26188.chunk.js.map